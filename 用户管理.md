# useradd 添加用户

## 常用命令

| 具体命令               | 命令效果                         |
| ---------------------- | -------------------------------- |
| useradd -u 1000 user1  | 新增一个uid为1000的用户user1     |
| useradd -g 9999 user2  | 新增一个user2，用户分组id为9999  |
| useradd -g user1 user3 | 新增一个user3，用户分组名为user1 |



## TLDR

```shell
  useradd

  Create a new user.
  See also: `users`, `userdel`, `usermod`.
  More information: https://manned.org/useradd.

  - Create a new user:
    sudo useradd username

  - Create a new user with the specified user id:
    sudo useradd --uid id username

  - Create a new user with the specified shell:
    sudo useradd --shell path/to/shell username

  - Create a new user belonging to additional groups (mind the lack of whitespace):
    sudo useradd --groups group1,group2,... username

  - Create a new user with the default home directory:
    sudo useradd --create-home username

  - Create a new user with the home directory filled by template directory files:
    sudo useradd --skel path/to/template_directory --create-home username

  - Create a new system user without the home directory:
    sudo useradd --system username
```

# userdel 删除用户

## 常用命令

| 具体命令          | 命令效果                                      |
| ----------------- | --------------------------------------------- |
| userdel -r user1  | 删除用户user1，并且删除他的家目录             |
| userdel -rf user2 | 删除用户user2和他的家目录，哪怕他仍在登录当中 |



## TLDR

```shell
  userdel

  Remove a user account or remove a user from a group.
  See also: `users`, `useradd`, `usermod`.
  More information: https://manned.org/userdel.

  - Remove a user:
    sudo userdel username

  - Remove a user in other root directory:
    sudo userdel --root path/to/other/root username

  - Remove a user along with the home directory and mail spool:
    sudo userdel --remove username
```

# groupadd 添加组

## 常用命令

| 具体命令               | 命令效果                    |
| ---------------------- | --------------------------- |
| groupadd -g 999 group1 | 添加一个组ID为999的用户组组 |



## TLDR

```shell
  groupadd

  Add user groups to the system.
  See also: `groups`, `groupdel`, `groupmod`.
  More information: https://manned.org/groupadd.

  - Create a new group:
    sudo groupadd group_name

  - Create a new system group:
    sudo groupadd --system group_name

  - Create a new group with the specific groupid:
    sudo groupadd --gid id group_name
```

# groupdel 删除组

## TLDR

```shell
  groupdel

  Delete existing user groups from the system.
  See also: `groups`, `groupadd`, `groupmod`.
  More information: https://manned.org/groupdel.

  - Delete an existing group:
    sudo groupdel group_name
```

# passwd 更改密码

## TLDR

```shell
  passwd

  Passwd is a tool used to change a user's password.
  More information: https://manned.org/passwd.

  - Change the password of the current user interactively:
    passwd

  - Change the password of a specific user:
    passwd username

  - Get the current status of the user:
    passwd -S

  - Make the password of the account blank (it will set the named account passwordless):
    passwd -d
```

# usermod 修改用户属性

## 常用命令

| 具体命令                         | 命令效果         |
| -------------------------------- | ---------------- |
| usermod -l new_username username | 修改用户的登录名 |
| usermod -u 2999 user1            | 修改用户的uid    |
| usermod -g group2 user1          | 修改用户分组     |
| usermod -aG group2 user1         | 附加用户分组     |
| usermod -L user1                 | 锁定用户         |
| usermod -U user1                 | 解锁用户         |



## TLDR

```shell
  usermod

  Modifies a user account.
  See also: `users`, `useradd`, `userdel`.
  More information: https://manned.org/usermod.

  - Change a username:
    sudo usermod --login new_username username

  - Change a user id:
    sudo usermod --uid id username

  - Change a user shell:
    sudo usermod --shell path/to/shell username

  - Add a user to supplementary groups (mind the lack of whitespace):
    sudo usermod --append --groups group1,group2,... username

  - Change a user home directory:
    sudo usermod --move-home --home path/to/new_home username
```

# chage 修改用户寿命

## TLDR

```shell
  chage

  Change user account and password expiry information.
  More information: https://manned.org/chage.

  - List password information for the user:
    chage --list username

  - Enable password expiration in 10 days:
    sudo chage --maxdays 10 username

  - Disable password expiration:
    sudo chage --maxdays -1 username

  - Set account expiration date:
    sudo chage --expiredate YYYY-MM-DD username

  - Force user to change password on next log in:
    sudo chage --lastday 0 username
```

# id 查看用户属性

## TLDR

```shell
  id

  Display current user and group identity.
  More information: https://www.gnu.org/software/coreutils/id.

  - Display current user's ID (UID), group ID (GID) and groups to which they belong:
    id

  - Display the current user identity as a number:
    id -u

  - Display the current group identity as a number:
    id -g

  - Display an arbitrary user's ID (UID), group ID (GID) and groups to which they belong:
    id username
```

# sudo以其他身份执行命令

## TLDR

```shell
  sudo

  Executes a single command as the superuser or another user.
  More information: https://www.sudo.ws/sudo.html.

  - Run a command as the superuser:
    sudo less /var/log/syslog

  - Edit a file as the superuser with your default editor:
    sudo --edit /etc/fstab

  - Run a command as another user and/or group:
    sudo --user=user --group=group id -a

  - Repeat the last command prefixed with `sudo` (only in `bash`, `zsh`, etc.):
    sudo !!

  - Launch the default shell with superuser privileges and run login-specific files (`.profile`, `.bash_profile`, etc.):
    sudo --login

  - Launch the default shell with superuser privileges without changing the environment:
    sudo --shell

  - Launch the default shell as the specified user, loading the user's environment and reading login-specific files (`.profile`, `.bash_profile`, etc.):
    sudo --login --user=user

  - List the allowed (and forbidden) commands for the invoking user:
    sudo --list
```



# 配置文件

## passwd文件解析

```shell
#每行文件实例
user2：x：10000:9999:remark:/home/user2:/bin/bash
```

| 具体命令    | 命令效果                                    |
| ----------- | ------------------------------------------- |
| user2       | 用户名                                      |
| x           | 是否需要密码登录，为空则不需要密码登录      |
| 10000       | uid                                         |
| 9999        | gid                                         |
| remark      | 用户备注                                    |
| /home/user2 | 用户家目录位置                              |
| /bin/bash   | 用户登录用bash，为/sbin/nologin则不允许登录 |



## 配置文件位置

```shell
#passwd保存所有的用户信息
vim /etc/passwd
#group保存所有的用户组信息
vim /etc/group
#shadow保存所有的用户密码信息
vim /etc/shadow
```

