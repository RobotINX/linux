# rpm 软件包管理工具

>**软件包全名      mysql-3.23.54a-11**

## 查询系统中安装了的包

```shell
#将所有安装过的包都列出来
rpm -qa
#只显示带有关键字mysql的包
rpm -qa | grep mysql
#查询某个软件包的全名
rpm -q mysql
#查询某个软件包安装目录
rpm -ql mysql
#查询可执行文件的位置
which mysql
#查询某个文件属于哪个软件包
rpm -qf /usr/bin/mysql
#卸载某个软件包
rpm -e mysql
#查询某个软件包的信息
rpm -i mysql
```

## TLDR

```shell
  rpm

  RPM Package Manager.
  More information: https://rpm.org/.

  - Show version of httpd package:
    rpm -q httpd

  - List versions of all matching packages:
    rpm -qa 'mariadb*'

  - Forcibly install a package regardless of currently installed versions:
    rpm -U package_name.rpm --force

  - Identify owner of a file and show version of the package:
    rpm -qf /etc/postfix/main.cf

  - List package-owned files:
    rpm -ql kernel

  - Show scriptlets from an RPM file:
    rpm -qp --scripts package_name.rpm

  - Show changed, missing and/or incorrectly installed files of matching packages:
    rpm -Va 'php-*'
```



# yum 基于RPM的软件包管理器

## 配置yum源

- 备份原来的文件

  ```shell
  mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
  ```

- 下载新的 `CentOS-Base.repo` 到 `/etc/yum.repos.d/`

  ```shell
  wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo
  ```

- 更新缓存

  ```shell
  yum clean all
  yum makecache
  ```

## yum相关指令

### 安装

```shell
#全部安装
yum install
#安装指定的包
yum install mysql
#安装程序组
yum groupinstall group1
```

### 更新和升级

```shell
#全部更新
yum update
#更新指定的程序包
yum update mysql
#检查可更新的程序
yum check-update
#升级指定程序包
yum upgrade mysql
#升级指定程序组
yum groupupgrade group1
```

### 查找和显示

```shell
#检查mysql是否已经安装
yum list installed | grep mysql
yum list installed mysql*
#显示安装包信息
yum info mysql
#显示所有包
yum list
#显示指定包名的安装情况
yum list mysql
#显示指定程序包组的安装信息
yum groupinfo group1
```

### 删除程序

```shell
#删除程序包httpd
yum remove httpd
yum erase httpd
#删除程序组group1
yum groupremove group1
#查看程序包的依赖情况
yum deplist package1
```

### 清除缓存

```shell
#清除缓存目录下的软件包
yum clean packages
#清除缓存目录下的headers
yum clean headers
```

## TLDR

```SHELL
  yum

  Package management utility for RHEL, Fedora, and CentOS (for older versions).
  More information: https://manned.org/yum.

  - Install a new package:
    yum install package

  - Install a new package and assume yes to all questions (also works with update, great for automated updates):
    yum -y install package

  - Find the package that provides a particular command:
    yum provides command

  - Remove a package:
    yum remove package

  - Display available updates for installed packages:
    yum check-update

  - Upgrade installed packages to the newest available versions:
    yum upgrade
```

# 内核升级

## 查看系统版本

```shell
#查看CPU信息
lscpu
#查看发行版本
cat /etc/redhat-release
#查看系统版本信息
cat /proc/version
uname -a
#操作系统信息
cat /etc/os-release
```

## 下载新版本内核

```shell
#导入ELRepo软件仓库的公共秘钥
rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
#安装ELRepo软件仓库的yum源
rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
#安装主线内核（ml=mainline）4.14.11
yum --enablerepo=elrepo-kernel install kernel-ml
#查看系统可用内核，因为是通过yum下载的内核，所以用yum查看
#如果是自己用源码编译的内核，主要看自己编译时放在哪个文件夹，当然建议是放在/usr/src/kernels文件夹下
yum list installed | grep kernel
#设置默认内核
grub2-set-default 0
#生成 grub 配置文件
grub2-mkconfig -o /boot/grub2/grub.cfg
#重启系统并查看内核版本
reboot
uname -a
cat /proc/version
```

# uname 查看系统信息

## TLDR

```shell
  uname

  Print details about the current machine and the operating system running on it.
  See also `lsb_release`.
  More information: https://www.gnu.org/software/coreutils/uname.

  - Print kernel name:
    uname

  - Print system architecture and processor information:
    uname --machine --processor

  - Print kernel name, kernel release and kernel version:
    uname --kernel-name --kernel-release --kernel-version

  - Print system hostname:
    uname --nodename

  - Print all available system information:
    uname --all
```




# 安装jdk

```shell
which java

cd /usr/bin
mv /usr/bin/java /usr/bin/java.bak

rpm -qa | grep java
rpm -ql java-11-openjdk-headless-11.0.12.0.7-0.el8_4.x86_64

ls -lrt /usr/bin/java
ls -lrt /etc/alternatives/java
cd /etc/alternatives/java

sudo yum install java-11-openjdk -y

rpm -qa | grep java
rpm -ql java-11-openjdk-headless-11.0.12.0.7-0.el8_4.x86_64
cd /usr/lib/jvm/java-11-openjdk-11.0.12.0.7-0.el8_4.x86_64/bin
pwd

/usr/lib/jvm/java-11-openjdk-11.0.12.0.7-0.el8_4.x86_64/bin
cp /etc/profile /etc/profile.bak

vim /etc/profile
export JAVA_HOME=/usr/lib/jvm
export PATH=$PATH:$JAVA_HOME/java-11-openjdk-11.0.12.0.7-0.el8_4.x86_64/bin
#export PATH=$PATH:/usr/lib/jvm/java-11-openjdk-11.0.12.0.7-0.el8_4.x86_64/bin

source /etc/profile

java -version
```

